{
  "Definition": [
    {
      "ID": "oval:org.altlinux.errata:def:20192271",
      "Version": "oval:org.altlinux.errata:def:20192271",
      "Class": "patch",
      "Metadata": {
        "Title": "ALT-PU-2019-2271: package `squid` update to version 4.8-alt1",
        "AffectedList": [
          {
            "Family": "unix",
            "Platforms": [
              "ALT Linux branch p9"
            ],
            "Products": [
              "ALT Server",
              "ALT Virtualization Server",
              "ALT Workstation",
              "ALT Workstation K",
              "ALT Education",
              "Simply Linux",
              "Starterkit"
            ]
          }
        ],
        "References": [
          {
            "RefID": "ALT-PU-2019-2271",
            "RefURL": "https://errata.altlinux.org/ALT-PU-2019-2271",
            "Source": "ALTPU"
          },
          {
            "RefID": "BDU:2020-01848",
            "RefURL": "https://bdu.fstec.ru/vul/2020-01848",
            "Source": "BDU"
          },
          {
            "RefID": "BDU:2020-02395",
            "RefURL": "https://bdu.fstec.ru/vul/2020-02395",
            "Source": "BDU"
          },
          {
            "RefID": "BDU:2020-02396",
            "RefURL": "https://bdu.fstec.ru/vul/2020-02396",
            "Source": "BDU"
          },
          {
            "RefID": "BDU:2020-02401",
            "RefURL": "https://bdu.fstec.ru/vul/2020-02401",
            "Source": "BDU"
          },
          {
            "RefID": "BDU:2020-02594",
            "RefURL": "https://bdu.fstec.ru/vul/2020-02594",
            "Source": "BDU"
          },
          {
            "RefID": "BDU:2020-02595",
            "RefURL": "https://bdu.fstec.ru/vul/2020-02595",
            "Source": "BDU"
          },
          {
            "RefID": "BDU:2020-03316",
            "RefURL": "https://bdu.fstec.ru/vul/2020-03316",
            "Source": "BDU"
          },
          {
            "RefID": "BDU:2021-01724",
            "RefURL": "https://bdu.fstec.ru/vul/2021-01724",
            "Source": "BDU"
          },
          {
            "RefID": "CVE-2019-12520",
            "RefURL": "https://nvd.nist.gov/vuln/detail/CVE-2019-12520",
            "Source": "CVE"
          },
          {
            "RefID": "CVE-2019-12521",
            "RefURL": "https://nvd.nist.gov/vuln/detail/CVE-2019-12521",
            "Source": "CVE"
          },
          {
            "RefID": "CVE-2019-12522",
            "RefURL": "https://nvd.nist.gov/vuln/detail/CVE-2019-12522",
            "Source": "CVE"
          },
          {
            "RefID": "CVE-2019-12524",
            "RefURL": "https://nvd.nist.gov/vuln/detail/CVE-2019-12524",
            "Source": "CVE"
          },
          {
            "RefID": "CVE-2019-12525",
            "RefURL": "https://nvd.nist.gov/vuln/detail/CVE-2019-12525",
            "Source": "CVE"
          },
          {
            "RefID": "CVE-2019-12527",
            "RefURL": "https://nvd.nist.gov/vuln/detail/CVE-2019-12527",
            "Source": "CVE"
          },
          {
            "RefID": "CVE-2019-12529",
            "RefURL": "https://nvd.nist.gov/vuln/detail/CVE-2019-12529",
            "Source": "CVE"
          },
          {
            "RefID": "CVE-2019-12854",
            "RefURL": "https://nvd.nist.gov/vuln/detail/CVE-2019-12854",
            "Source": "CVE"
          },
          {
            "RefID": "CVE-2019-13345",
            "RefURL": "https://nvd.nist.gov/vuln/detail/CVE-2019-13345",
            "Source": "CVE"
          }
        ],
        "Description": "This update upgrades squid to version 4.8-alt1. \nSecurity Fix(es):\n\n * BDU:2020-01848: Уязвимость прокси-сервера Squid, связанная с отсутствием защиты служебных данных, позволяющая нарушителю раскрыть защищаемую информацию\n\n * BDU:2020-02395: Уязвимость компонента Proxy-Authentication прокси-сервера Squid, позволяющая нарушителю вызвать отказ в обслуживании или выполнить произвольный код\n\n * BDU:2020-02396: Уязвимость функции HttpHeader::getAuth прокси-сервера Squid, позволяющая нарушителю вызвать отказ в обслуживании или выполнить произвольный код\n\n * BDU:2020-02401: Уязвимость утилиты cachemgr.cgi прокси-сервера Squid, позволяющая нарушителю осуществлять межсайтовые сценарные атаки\n\n * BDU:2020-02594: Уязвимость прокси-сервера Squid, существующая из-за недостаточной проверки входных данных, позволяющая нарушителю получить доступ к функциям, которые могут использовать только обратные прокси\n\n * BDU:2020-02595: Уязвимость прокси-сервера Squid, связанная с отсутствием механизма аутентификации для url_regex, позволяющая нарушителю получить доступ к заблокированному ресурсу\n\n * BDU:2020-03316: Уязвимость компонента cachemgr.cgi прокси-сервера Squid, позволяющая нарушителю вызвать отказ в обслуживании\n\n * BDU:2021-01724: Уязвимость механизма обработки элементов ESI прокси-сервера Squid, связанная с выходом операции за допустимые границы буфера данных, позволяющая нарушителю вызвать отказ в обслуживании\n\n * CVE-2019-12520: An issue was discovered in Squid through 4.7 and 5. When receiving a request, Squid checks its cache to see if it can serve up a response. It does this by making a MD5 hash of the absolute URL of the request. If found, it servers the request. The absolute URL can include the decoded UserInfo (username and password) for certain protocols. This decoded info is prepended to the domain. This allows an attacker to provide a username that has special characters to delimit the domain, and treat the rest of the URL as a path or query string. An attacker could first make a request to their domain using an encoded username, then when a request for the target domain comes in that decodes to the exact URL, it will serve the attacker's HTML instead of the real HTML. On Squid servers that also act as reverse proxies, this allows an attacker to gain access to features that only reverse proxies can use, such as ESI.\n\n * CVE-2019-12521: An issue was discovered in Squid through 4.7. When Squid is parsing ESI, it keeps the ESI elements in ESIContext. ESIContext contains a buffer for holding a stack of ESIElements. When a new ESIElement is parsed, it is added via addStackElement. addStackElement has a check for the number of elements in this buffer, but it's off by 1, leading to a Heap Overflow of 1 element. The overflow is within the same structure so it can't affect adjacent memory blocks, and thus just leads to a crash while processing.\n\n * CVE-2019-12522: An issue was discovered in Squid through 4.7. When Squid is run as root, it spawns its child processes as a lesser user, by default the user nobody. This is done via the leave_suid call. leave_suid leaves the Saved UID as 0. This makes it trivial for an attacker who has compromised the child process to escalate their privileges back to root.\n\n * CVE-2019-12524: An issue was discovered in Squid through 4.7. When handling requests from users, Squid checks its rules to see if the request should be denied. Squid by default comes with rules to block access to the Cache Manager, which serves detailed server information meant for the maintainer. This rule is implemented via url_regex. The handler for url_regex rules URL decodes an incoming request. This allows an attacker to encode their URL to bypass the url_regex check, and gain access to the blocked resource.\n\n * CVE-2019-12525: An issue was discovered in Squid 3.3.9 through 3.5.28 and 4.x through 4.7. When Squid is configured to use Digest authentication, it parses the header Proxy-Authorization. It searches for certain tokens such as domain, uri, and qop. Squid checks if this token's value starts with a quote and ends with one. If so, it performs a memcpy of its length minus 2. Squid never checks whether the value is just a single quote (which would satisfy its requirements), leading to a memcpy of its length minus 1.\n\n * CVE-2019-12527: An issue was discovered in Squid 4.0.23 through 4.7. When checking Basic Authentication with HttpHeader::getAuth, Squid uses a global buffer to store the decoded data. Squid does not check that the decoded length isn't greater than the buffer, leading to a heap-based buffer overflow with user controlled data.\n\n * CVE-2019-12529: An issue was discovered in Squid 2.x through 2.7.STABLE9, 3.x through 3.5.28, and 4.x through 4.7. When Squid is configured to use Basic Authentication, the Proxy-Authorization header is parsed via uudecode. uudecode determines how many bytes will be decoded by iterating over the input and checking its table. The length is then used to start decoding the string. There are no checks to ensure that the length it calculates isn't greater than the input buffer. This leads to adjacent memory being decoded as well. An attacker would not be able to retrieve the decoded data unless the Squid maintainer had configured the display of usernames on error pages.\n\n * CVE-2019-12854: Due to incorrect string termination, Squid cachemgr.cgi 4.0 through 4.7 may access unallocated memory. On systems with memory access protections, this can cause the CGI process to terminate unexpectedly, resulting in a denial of service for all clients using it.\n\n * CVE-2019-13345: The cachemgr.cgi web module of Squid through 4.7 has XSS via the user_name or auth parameter.",
        "Advisory": {
          "From": "errata.altlinux.org",
          "Severity": "Critical",
          "Rights": "Copyright 2023 BaseALT Ltd.",
          "Issued": {
            "Date": "2019-07-16"
          },
          "Updated": {
            "Date": "2019-07-16"
          },
          "bdu": [
            {
              "Cvss": "AV:N/AC:M/Au:N/C:P/I:N/A:N",
              "Cvss3": "AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N",
              "Cwe": "CWE-200",
              "Href": "https://bdu.fstec.ru/vul/2020-01848",
              "Impact": "Low",
              "Public": "20190711",
              "CveID": "BDU:2020-01848"
            },
            {
              "Cvss": "AV:N/AC:L/Au:N/C:P/I:P/A:P",
              "Cvss3": "AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
              "Cwe": "CWE-119",
              "Href": "https://bdu.fstec.ru/vul/2020-02395",
              "Impact": "Critical",
              "Public": "20190711",
              "CveID": "BDU:2020-02395"
            },
            {
              "Cvss": "AV:N/AC:L/Au:N/C:C/I:C/A:C",
              "Cvss3": "AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
              "Cwe": "CWE-119",
              "Href": "https://bdu.fstec.ru/vul/2020-02396",
              "Impact": "High",
              "Public": "20190711",
              "CveID": "BDU:2020-02396"
            },
            {
              "Cvss": "AV:N/AC:M/Au:N/C:P/I:P/A:N",
              "Cvss3": "AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
              "Cwe": "CWE-79",
              "Href": "https://bdu.fstec.ru/vul/2020-02401",
              "Impact": "Low",
              "Public": "20190705",
              "CveID": "BDU:2020-02401"
            },
            {
              "Cvss": "AV:N/AC:L/Au:N/C:P/I:N/A:N",
              "Cvss3": "AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
              "Cwe": "CWE-20",
              "Href": "https://bdu.fstec.ru/vul/2020-02594",
              "Impact": "High",
              "Public": "20200415",
              "CveID": "BDU:2020-02594"
            },
            {
              "Cvss": "AV:N/AC:L/Au:N/C:P/I:P/A:P",
              "Cwe": "CWE-306",
              "Href": "https://bdu.fstec.ru/vul/2020-02595",
              "Impact": "High",
              "Public": "20200415",
              "CveID": "BDU:2020-02595"
            },
            {
              "Cvss": "AV:N/AC:L/Au:N/C:N/I:N/A:C",
              "Cvss3": "AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
              "Cwe": "CWE-119",
              "Href": "https://bdu.fstec.ru/vul/2020-03316",
              "Impact": "High",
              "Public": "20190815",
              "CveID": "BDU:2020-03316"
            },
            {
              "Cvss": "AV:N/AC:M/Au:N/C:N/I:N/A:P",
              "Cvss3": "AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H",
              "Cwe": "CWE-787",
              "Href": "https://bdu.fstec.ru/vul/2021-01724",
              "Impact": "Low",
              "Public": "20200415",
              "CveID": "BDU:2021-01724"
            }
          ],
          "Cves": [
            {
              "Cvss": "AV:N/AC:L/Au:N/C:P/I:N/A:N",
              "Cvss3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
              "Cwe": "CWE-20",
              "Href": "https://nvd.nist.gov/vuln/detail/CVE-2019-12520",
              "Impact": "High",
              "Public": "20200415",
              "CveID": "CVE-2019-12520"
            },
            {
              "Cvss": "AV:N/AC:M/Au:N/C:N/I:N/A:P",
              "Cvss3": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H",
              "Cwe": "CWE-787",
              "Href": "https://nvd.nist.gov/vuln/detail/CVE-2019-12521",
              "Impact": "Low",
              "Public": "20200415",
              "CveID": "CVE-2019-12521"
            },
            {
              "Cvss": "AV:L/AC:M/Au:N/C:P/I:P/A:P",
              "Cvss3": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:L",
              "Cwe": "CWE-269",
              "Href": "https://nvd.nist.gov/vuln/detail/CVE-2019-12522",
              "Impact": "Low",
              "Public": "20200415",
              "CveID": "CVE-2019-12522"
            },
            {
              "Cvss": "AV:N/AC:L/Au:N/C:P/I:P/A:P",
              "Cvss3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
              "Cwe": "CWE-306",
              "Href": "https://nvd.nist.gov/vuln/detail/CVE-2019-12524",
              "Impact": "Critical",
              "Public": "20200415",
              "CveID": "CVE-2019-12524"
            },
            {
              "Cvss": "AV:N/AC:L/Au:N/C:P/I:P/A:P",
              "Cvss3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
              "Cwe": "CWE-787",
              "Href": "https://nvd.nist.gov/vuln/detail/CVE-2019-12525",
              "Impact": "Critical",
              "Public": "20190711",
              "CveID": "CVE-2019-12525"
            },
            {
              "Cvss": "AV:N/AC:M/Au:N/C:P/I:P/A:P",
              "Cvss3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
              "Cwe": "CWE-787",
              "Href": "https://nvd.nist.gov/vuln/detail/CVE-2019-12527",
              "Impact": "High",
              "Public": "20190711",
              "CveID": "CVE-2019-12527"
            },
            {
              "Cvss": "AV:N/AC:M/Au:N/C:P/I:N/A:N",
              "Cvss3": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N",
              "Cwe": "CWE-125",
              "Href": "https://nvd.nist.gov/vuln/detail/CVE-2019-12529",
              "Impact": "Low",
              "Public": "20190711",
              "CveID": "CVE-2019-12529"
            },
            {
              "Cvss": "AV:N/AC:L/Au:N/C:N/I:N/A:P",
              "Cvss3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
              "Cwe": "NVD-CWE-noinfo",
              "Href": "https://nvd.nist.gov/vuln/detail/CVE-2019-12854",
              "Impact": "High",
              "Public": "20190815",
              "CveID": "CVE-2019-12854"
            },
            {
              "Cvss": "AV:N/AC:M/Au:N/C:N/I:P/A:N",
              "Cvss3": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
              "Cwe": "CWE-79",
              "Href": "https://nvd.nist.gov/vuln/detail/CVE-2019-13345",
              "Impact": "Low",
              "Public": "20190705",
              "CveID": "CVE-2019-13345"
            }
          ],
          "AffectedCpeList": {
            "Cpe": [
              "cpe:/o:alt:kworkstation:9",
              "cpe:/o:alt:workstation:9",
              "cpe:/o:alt:server:9",
              "cpe:/o:alt:server-v:9",
              "cpe:/o:alt:education:9",
              "cpe:/o:alt:slinux:9",
              "cpe:/o:alt:starterkit:p9",
              "cpe:/o:alt:kworkstation:9.1",
              "cpe:/o:alt:workstation:9.1",
              "cpe:/o:alt:server:9.1",
              "cpe:/o:alt:server-v:9.1",
              "cpe:/o:alt:education:9.1",
              "cpe:/o:alt:slinux:9.1",
              "cpe:/o:alt:starterkit:9.1",
              "cpe:/o:alt:kworkstation:9.2",
              "cpe:/o:alt:workstation:9.2",
              "cpe:/o:alt:server:9.2",
              "cpe:/o:alt:server-v:9.2",
              "cpe:/o:alt:education:9.2",
              "cpe:/o:alt:slinux:9.2",
              "cpe:/o:alt:starterkit:9.2"
            ]
          }
        }
      },
      "Criteria": {
        "Operator": "AND",
        "Criterions": [
          {
            "TestRef": "oval:org.altlinux.errata:tst:1001",
            "Comment": "ALT Linux must be installed"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterions": [
              {
                "TestRef": "oval:org.altlinux.errata:tst:20192271001",
                "Comment": "squid is earlier than 0:4.8-alt1"
              },
              {
                "TestRef": "oval:org.altlinux.errata:tst:20192271002",
                "Comment": "squid-doc is earlier than 0:4.8-alt1"
              },
              {
                "TestRef": "oval:org.altlinux.errata:tst:20192271003",
                "Comment": "squid-helpers is earlier than 0:4.8-alt1"
              }
            ]
          }
        ]
      }
    }
  ]
}