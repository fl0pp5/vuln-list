{
  "Definition": [
    {
      "ID": "oval:org.altlinux.errata:def:20222699",
      "Version": "oval:org.altlinux.errata:def:20222699",
      "Class": "patch",
      "Metadata": {
        "Title": "ALT-PU-2022-2699: package `ruby` update to version 2.7.6-alt0.1.c9f2",
        "AffectedList": [
          {
            "Family": "unix",
            "Platforms": [
              "ALT Linux branch c9f2"
            ],
            "Products": [
              "ALT SPWorkstation",
              "ALT SPServer"
            ]
          }
        ],
        "References": [
          {
            "RefID": "ALT-PU-2022-2699",
            "RefURL": "https://errata.altlinux.org/ALT-PU-2022-2699",
            "Source": "ALTPU"
          },
          {
            "RefID": "BDU:2022-00302",
            "RefURL": "https://bdu.fstec.ru/vul/2022-00302",
            "Source": "BDU"
          },
          {
            "RefID": "BDU:2022-03067",
            "RefURL": "https://bdu.fstec.ru/vul/2022-03067",
            "Source": "BDU"
          },
          {
            "RefID": "BDU:2022-03068",
            "RefURL": "https://bdu.fstec.ru/vul/2022-03068",
            "Source": "BDU"
          },
          {
            "RefID": "BDU:2022-05837",
            "RefURL": "https://bdu.fstec.ru/vul/2022-05837",
            "Source": "BDU"
          },
          {
            "RefID": "CVE-2021-28965",
            "RefURL": "https://nvd.nist.gov/vuln/detail/CVE-2021-28965",
            "Source": "CVE"
          },
          {
            "RefID": "CVE-2021-41819",
            "RefURL": "https://nvd.nist.gov/vuln/detail/CVE-2021-41819",
            "Source": "CVE"
          },
          {
            "RefID": "CVE-2022-28738",
            "RefURL": "https://nvd.nist.gov/vuln/detail/CVE-2022-28738",
            "Source": "CVE"
          },
          {
            "RefID": "CVE-2022-28739",
            "RefURL": "https://nvd.nist.gov/vuln/detail/CVE-2022-28739",
            "Source": "CVE"
          }
        ],
        "Description": "This update upgrades ruby to version 2.7.6-alt0.1.c9f2. \nSecurity Fix(es):\n\n * BDU:2022-00302: Уязвимость интерпретатора языка программирования Ruby, связанная с неверным ограничением XML-ссылок на внешние объекты, позволяющая нарушителю оказать воздействие на целостность данных\n\n * BDU:2022-03067: Уязвимость методов алгоритма преобразования строки в число с плавающей запятой Kernel#Float и String#to_f интерпретатора языка программирования Ruby, позволяющая нарушителю вызвать отказ в обслуживании\n\n * BDU:2022-03068: Уязвимость реализации класса Regexp интерпретатора языка программирования Ruby, позволяющая нарушителю вызвать отказ в обслуживании\n\n * BDU:2022-05837: Уязвимость функции CGI::Cookie.parse языка программирования Ruby, позволяющая нарушителю оказать воздействие на целостность данных\n\n * CVE-2021-28965: The REXML gem before 3.2.5 in Ruby before 2.6.7, 2.7.x before 2.7.3, and 3.x before 3.0.1 does not properly address XML round-trip issues. An incorrect document can be produced after parsing and serializing.\n\n * CVE-2021-41819: CGI::Cookie.parse in Ruby through 2.6.8 mishandles security prefixes in cookie names. This also affects the CGI gem through 0.3.0 for Ruby.\n\n * CVE-2022-28738: A double free was found in the Regexp compiler in Ruby 3.x before 3.0.4 and 3.1.x before 3.1.2. If a victim attempts to create a Regexp from untrusted user input, an attacker may be able to write to unexpected memory locations.\n\n * CVE-2022-28739: There is a buffer over-read in Ruby before 2.6.10, 2.7.x before 2.7.6, 3.x before 3.0.4, and 3.1.x before 3.1.2. It occurs in String-to-Float conversion, including Kernel#Float and String#to_f.\n\n * #41688: Пути в $LOAD_PATH и %ruby_sitearchdir версионированы по PATCH",
        "Advisory": {
          "From": "errata.altlinux.org",
          "Severity": "Critical",
          "Rights": "Copyright 2023 BaseALT Ltd.",
          "Issued": {
            "Date": "2022-09-30"
          },
          "Updated": {
            "Date": "2022-09-30"
          },
          "bdu": [
            {
              "Cvss": "AV:N/AC:L/Au:N/C:N/I:P/A:N",
              "Cvss3": "AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N",
              "Cwe": "CWE-611",
              "Href": "https://bdu.fstec.ru/vul/2022-00302",
              "Impact": "High",
              "Public": "20210412",
              "CveID": "BDU:2022-00302"
            },
            {
              "Cvss": "AV:N/AC:M/Au:N/C:C/I:N/A:N",
              "Cvss3": "AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
              "Cwe": "CWE-119, CWE-125, CWE-704",
              "Href": "https://bdu.fstec.ru/vul/2022-03067",
              "Impact": "High",
              "Public": "20220412",
              "CveID": "BDU:2022-03067"
            },
            {
              "Cvss": "AV:L/AC:L/Au:N/C:N/I:C/A:N",
              "Cvss3": "AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N",
              "Cwe": "CWE-119, CWE-415",
              "Href": "https://bdu.fstec.ru/vul/2022-03068",
              "Impact": "Low",
              "Public": "20220412",
              "CveID": "BDU:2022-03068"
            },
            {
              "Cvss": "AV:N/AC:L/Au:N/C:N/I:C/A:N",
              "Cvss3": "AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N",
              "Cwe": "CWE-565",
              "Href": "https://bdu.fstec.ru/vul/2022-05837",
              "Impact": "High",
              "Public": "20211124",
              "CveID": "BDU:2022-05837"
            }
          ],
          "Cves": [
            {
              "Cvss": "AV:N/AC:L/Au:N/C:N/I:P/A:N",
              "Cvss3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N",
              "Cwe": "NVD-CWE-Other",
              "Href": "https://nvd.nist.gov/vuln/detail/CVE-2021-28965",
              "Impact": "High",
              "Public": "20210421",
              "CveID": "CVE-2021-28965"
            },
            {
              "Cvss": "AV:N/AC:L/Au:N/C:N/I:P/A:N",
              "Cvss3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N",
              "Cwe": "CWE-565",
              "Href": "https://nvd.nist.gov/vuln/detail/CVE-2021-41819",
              "Impact": "High",
              "Public": "20220101",
              "CveID": "CVE-2021-41819"
            },
            {
              "Cvss": "AV:N/AC:L/Au:N/C:P/I:P/A:P",
              "Cvss3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
              "Cwe": "CWE-415",
              "Href": "https://nvd.nist.gov/vuln/detail/CVE-2022-28738",
              "Impact": "Critical",
              "Public": "20220509",
              "CveID": "CVE-2022-28738"
            },
            {
              "Cvss": "AV:N/AC:M/Au:N/C:P/I:N/A:N",
              "Cvss3": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
              "Cwe": "CWE-125",
              "Href": "https://nvd.nist.gov/vuln/detail/CVE-2022-28739",
              "Impact": "High",
              "Public": "20220509",
              "CveID": "CVE-2022-28739"
            }
          ],
          "Bugzilla": [
            {
              "Id": "41688",
              "Href": "https://bugzilla.altlinux.org/41688",
              "Data": "Пути в $LOAD_PATH и %ruby_sitearchdir версионированы по PATCH"
            }
          ],
          "AffectedCpeList": {
            "Cpe": [
              "cpe:/o:alt:spworkstation:8.4",
              "cpe:/o:alt:spserver:8.4"
            ]
          }
        }
      },
      "Criteria": {
        "Operator": "AND",
        "Criterions": [
          {
            "TestRef": "oval:org.altlinux.errata:tst:3001",
            "Comment": "ALT Linux must be installed"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterions": [
              {
                "TestRef": "oval:org.altlinux.errata:tst:20222699001",
                "Comment": "erb is earlier than 0:2.7.6-alt0.1.c9f2"
              },
              {
                "TestRef": "oval:org.altlinux.errata:tst:20222699002",
                "Comment": "gem is earlier than 2:3.1.6-alt1.4.1.c9f2"
              },
              {
                "TestRef": "oval:org.altlinux.errata:tst:20222699003",
                "Comment": "irb is earlier than 0:2.7.6-alt0.1.c9f2"
              },
              {
                "TestRef": "oval:org.altlinux.errata:tst:20222699004",
                "Comment": "libruby is earlier than 0:2.7.6-alt0.1.c9f2"
              },
              {
                "TestRef": "oval:org.altlinux.errata:tst:20222699005",
                "Comment": "libruby-devel is earlier than 0:2.7.6-alt0.1.c9f2"
              },
              {
                "TestRef": "oval:org.altlinux.errata:tst:20222699006",
                "Comment": "libruby-devel-static is earlier than 0:2.7.6-alt0.1.c9f2"
              },
              {
                "TestRef": "oval:org.altlinux.errata:tst:20222699007",
                "Comment": "ri-doc is earlier than 0:2.7.6-alt0.1.c9f2"
              },
              {
                "TestRef": "oval:org.altlinux.errata:tst:20222699008",
                "Comment": "ruby is earlier than 0:2.7.6-alt0.1.c9f2"
              },
              {
                "TestRef": "oval:org.altlinux.errata:tst:20222699009",
                "Comment": "ruby-doc is earlier than 0:2.7.6-alt0.1.c9f2"
              },
              {
                "TestRef": "oval:org.altlinux.errata:tst:20222699010",
                "Comment": "ruby-miniruby-src is earlier than 0:2.7.6-alt0.1.c9f2"
              },
              {
                "TestRef": "oval:org.altlinux.errata:tst:20222699011",
                "Comment": "ruby-stdlibs is earlier than 0:2.7.6-alt0.1.c9f2"
              }
            ]
          }
        ]
      }
    }
  ]
}